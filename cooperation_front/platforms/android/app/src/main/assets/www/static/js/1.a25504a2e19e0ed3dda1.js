webpackJsonp([1],{"0exO":function(e,t,r){e.exports=r.p+"scene.gltf"},"3C/1":function(e,t,r){r("M6a0"),r("zQR9"),r("+tPU"),r("qCoq"),r("UvrK"),r("Xjd4"),r("bqnK"),e.exports=r("FeBl").Map},"4WTo":function(e,t,r){var n=r("NWt+");e.exports=function(e,t){var r=[];return n(e,!1,r.push,r,t),r}},"7Doy":function(e,t,r){var n=r("EqjI"),a=r("7UMu"),i=r("dSzd")("species");e.exports=function(e){var t;return a(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!a(t.prototype)||(t=void 0),n(t)&&null===(t=t[i])&&(t=void 0)),void 0===t?Array:t}},"7jkF":function(e,t,r){e.exports=r.p+"static/img/house.f231691.jpg"},"8yxd":function(e,t,r){e.exports=r.p+"pusheen.fbx"},"9Bbf":function(e,t,r){"use strict";var n=r("kM2E");e.exports=function(e){n(n.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},"9C8M":function(e,t,r){"use strict";var n=r("evD5").f,a=r("Yobk"),i=r("xH/j"),o=r("+ZMJ"),s=r("2KxR"),l=r("NWt+"),u=r("vIB/"),c=r("EGZi"),p=r("bRrM"),h=r("+E39"),f=r("06OY").fastKey,d=r("LIJb"),v=h?"_s":"size",m=function(e,t){var r,n=f(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r};e.exports={getConstructor:function(e,t,r,u){var c=e(function(e,n){s(e,c,t,"_i"),e._t=t,e._i=a(null),e._f=void 0,e._l=void 0,e[v]=0,void 0!=n&&l(n,r,e[u],e)});return i(c.prototype,{clear:function(){for(var e=d(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[v]=0},delete:function(e){var r=d(this,t),n=m(r,e);if(n){var a=n.n,i=n.p;delete r._i[n.i],n.r=!0,i&&(i.n=a),a&&(a.p=i),r._f==n&&(r._f=a),r._l==n&&(r._l=i),r[v]--}return!!n},forEach:function(e){d(this,t);for(var r,n=o(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!m(d(this,t),e)}}),h&&n(c.prototype,"size",{get:function(){return d(this,t)[v]}}),c},def:function(e,t,r){var n,a,i=m(e,t);return i?i.v=r:(e._l=i={i:a=f(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=i),n&&(n.n=i),e[v]++,"F"!==a&&(e._i[a]=i)),e},getEntry:m,setStrong:function(e,t,r){u(e,t,function(e,r){this._t=d(e,t),this._k=r,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?c(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,c(1))},r?"entries":"values",!r,!0),p(t)}}},ALrJ:function(e,t,r){var n=r("+ZMJ"),a=r("MU5D"),i=r("sB3e"),o=r("QRG4"),s=r("oeOm");e.exports=function(e,t){var r=1==e,l=2==e,u=3==e,c=4==e,p=6==e,h=5==e||p,f=t||s;return function(t,s,d){for(var v,m,g=i(t),E=a(g),T=n(s,d,3),y=o(E.length),R=0,w=r?f(t,y):l?f(t,0):void 0;y>R;R++)if((h||R in E)&&(m=T(v=E[R],R,g),e))if(r)w[R]=m;else if(m)switch(e){case 3:return!0;case 5:return v;case 6:return R;case 2:w.push(v)}else if(c)return!1;return p?-1:u||c?c:w}}},Cdx3:function(e,t,r){var n=r("sB3e"),a=r("lktj");r("uqUo")("keys",function(){return function(e){return a(n(e))}})},"ED/J":function(e,t){},HpRW:function(e,t,r){"use strict";var n=r("kM2E"),a=r("lOnJ"),i=r("+ZMJ"),o=r("NWt+");e.exports=function(e){n(n.S,e,{from:function(e){var t,r,n,s,l=arguments[1];return a(this),(t=void 0!==l)&&a(l),void 0==e?new this:(r=[],t?(n=0,s=i(l,arguments[2],2),o(e,!1,function(e){r.push(s(e,n++))})):o(e,!1,r.push,r),new this(r))}})}},LIJb:function(e,t,r){var n=r("EqjI");e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},NEFZ:function(e,t,r){e.exports=r.p+"static/img/mouse.867d296.png"},OfFw:function(e,t,r){e.exports=r.p+"static/img/house.37db486.jpeg"},OvRC:function(e,t,r){e.exports={default:r("oM7Q"),__esModule:!0}},QWiY:function(e,t,r){e.exports=r.p+"static/img/dog.a8d4210.jpg"},UvrK:function(e,t,r){var n=r("kM2E");n(n.P+n.R,"Map",{toJSON:r("m9gC")("Map")})},Xjd4:function(e,t,r){r("9Bbf")("Map")},bqnK:function(e,t,r){r("HpRW")("Map")},cQq1:function(e,t,r){e.exports=r.p+"static/img/cat.8abee4b.jpg"},fZjL:function(e,t,r){e.exports={default:r("jFbC"),__esModule:!0}},ifoU:function(e,t,r){e.exports={default:r("3C/1"),__esModule:!0}},jFbC:function(e,t,r){r("Cdx3"),e.exports=r("FeBl").Object.keys},m9gC:function(e,t,r){var n=r("RY/4"),a=r("4WTo");e.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return a(this)}}},oM7Q:function(e,t,r){r("sF+V");var n=r("FeBl").Object;e.exports=function(e,t){return n.create(e,t)}},oeOm:function(e,t,r){var n=r("7Doy");e.exports=function(e,t){return new(n(e))(t)}},qCoq:function(e,t,r){"use strict";var n=r("9C8M"),a=r("LIJb");e.exports=r("qo66")("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=n.getEntry(a(this,"Map"),e);return t&&t.v},set:function(e,t){return n.def(a(this,"Map"),0===e?0:e,t)}},n,!0)},qo66:function(e,t,r){"use strict";var n=r("7KvD"),a=r("kM2E"),i=r("06OY"),o=r("S82l"),s=r("hJx8"),l=r("xH/j"),u=r("NWt+"),c=r("2KxR"),p=r("EqjI"),h=r("e6n0"),f=r("evD5").f,d=r("ALrJ")(0),v=r("+E39");e.exports=function(e,t,r,m,g,E){var T=n[e],y=T,R=g?"set":"add",w=y&&y.prototype,M={};return v&&"function"==typeof y&&(E||w.forEach&&!o(function(){(new y).entries().next()}))?(y=t(function(t,r){c(t,y,e,"_c"),t._c=new T,void 0!=r&&u(r,g,t[R],t)}),d("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in w&&(!E||"clear"!=e)&&s(y.prototype,e,function(r,n){if(c(this,y,e),!t&&E&&!p(r))return"get"==e&&void 0;var a=this._c[e](0===r?0:r,n);return t?this:a})}),E||f(y.prototype,"size",{get:function(){return this._c.size}})):(y=m.getConstructor(t,e,g,R),l(y.prototype,r),i.NEED=!0),h(y,e),M[e]=y,a(a.G+a.W+a.F,M),E||m.setStrong(y,e,g),y}},"sF+V":function(e,t,r){var n=r("kM2E");n(n.S,"Object",{create:r("Yobk")})},uVI1:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("Xxa5"),a=r.n(n),i=r("exGp"),o=r.n(i),s=r("TVmP"),l=r("fZjL"),u=r.n(l),c=r("QWiY"),p=r.n(c),h=r("NEFZ"),f=r.n(h),d=r("7jkF"),v=r.n(d),m=r("pFYg"),g=r.n(m),E=r("ifoU"),T=r.n(E),y=r("OvRC"),R=r.n(y),w=r("woOf"),M=r.n(w),b=function(){var e,t,r;function n(e){THREE.Loader.call(this,e)}function a(e,t){this.textureLoader=e,this.manager=t}function i(){}function o(){}function s(){}function l(){}function c(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}function p(){}function h(e){var t=e.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function f(e){return e/46186158e3}n.prototype=M()(R()(THREE.Loader.prototype),{constructor:n,load:function(e,t,r,n){var a=this,i=""===a.path?THREE.LoaderUtils.extractUrlBase(e):a.path,o=new THREE.FileLoader(this.manager);o.setPath(a.path),o.setResponseType("arraybuffer"),o.load(e,function(r){try{t(a.parse(r,i))}catch(t){setTimeout(function(){n&&n(t),a.manager.itemError(e)},0)}},r,n)},parse:function(t,r){if(o="Kaydara FBX Binary  \0",(i=t).byteLength>=o.length&&o===x(i,0,o.length))e=(new l).parse(t);else{var n=x(t);if(!function(e){var t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],r=0;function n(t){var n=e[t-1];return e=e.slice(r+t),r++,n}for(var a=0;a<t.length;++a){var i=n(1);if(i===t[a])return!1}return!0}(n))throw new Error("THREE.FBXLoader: Unknown format.");if(h(n)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+h(n));e=(new s).parse(n)}var i,o;return new a(new THREE.TextureLoader(this.manager).setPath(this.resourcePath||r).setCrossOrigin(this.crossOrigin),this.manager).parse(e)}}),a.prototype={constructor:a,parse:function(){t=this.parseConnections();var e=this.parseImages(),n=this.parseTextures(e),a=this.parseMaterials(n),o=this.parseDeformers(),s=(new i).parse(o);return this.parseScene(o,s,a),r},parseConnections:function(){var t=new T.a;"Connections"in e&&e.Connections.connections.forEach(function(e){var r=e[0],n=e[1],a=e[2];t.has(r)||t.set(r,{parents:[],children:[]});var i={ID:n,relationship:a};t.get(r).parents.push(i),t.has(n)||t.set(n,{parents:[],children:[]});var o={ID:r,relationship:a};t.get(n).children.push(o)});return t},parseImages:function(){var t={},r={};if("Video"in e.Objects){var n=e.Objects.Video;for(var a in n){var i=n[a];if(t[u=parseInt(a)]=i.RelativeFilename||i.Filename,"Content"in i){var o=i.Content instanceof ArrayBuffer&&i.Content.byteLength>0,s="string"==typeof i.Content&&""!==i.Content;if(o||s){var l=this.parseImage(n[a]);r[i.RelativeFilename||i.Filename]=l}}}}for(var u in t){var c=t[u];void 0!==r[c]?t[u]=r[c]:t[u]=t[u].split("\\").pop()}return t},parseImage:function(e){var t,r=e.Content,n=e.RelativeFilename||e.Filename,a=n.slice(n.lastIndexOf(".")+1).toLowerCase();switch(a){case"bmp":t="image/bmp";break;case"jpg":case"jpeg":t="image/jpeg";break;case"png":t="image/png";break;case"tif":t="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",n),t="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+a+'" is not supported.')}if("string"==typeof r)return"data:"+t+";base64,"+r;var i=new Uint8Array(r);return window.URL.createObjectURL(new Blob([i],{type:t}))},parseTextures:function(t){var r=new T.a;if("Texture"in e.Objects){var n=e.Objects.Texture;for(var a in n){var i=this.parseTexture(n[a],t);r.set(parseInt(a),i)}}return r},parseTexture:function(e,t){var r=this.loadTexture(e,t);r.ID=e.id,r.name=e.attrName;var n=e.WrapModeU,a=e.WrapModeV,i=void 0!==n?n.value:0,o=void 0!==a?a.value:0;if(r.wrapS=0===i?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,r.wrapT=0===o?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,"Scaling"in e){var s=e.Scaling.value;r.repeat.x=s[0],r.repeat.y=s[1]}return r},loadTexture:function(e,r){var n,a,i=this.textureLoader.path,o=t.get(e.id).children;void 0!==o&&o.length>0&&void 0!==r[o[0].ID]&&(0!==(n=r[o[0].ID]).indexOf("blob:")&&0!==n.indexOf("data:")||this.textureLoader.setPath(void 0));var s=e.FileName.slice(-3).toLowerCase();if("tga"===s){var l=this.manager.getHandler(".tga");null===l?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),a=new THREE.Texture):a=l.load(n)}else"psd"===s?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),a=new THREE.Texture):a=this.textureLoader.load(n);return this.textureLoader.setPath(i),a},parseMaterials:function(t){var r=new T.a;if("Material"in e.Objects){var n=e.Objects.Material;for(var a in n){var i=this.parseMaterial(n[a],t);null!==i&&r.set(parseInt(a),i)}}return r},parseMaterial:function(e,r){var n=e.id,a=e.attrName,i=e.ShadingModel;if("object"===(void 0===i?"undefined":g()(i))&&(i=i.value),!t.has(n))return null;var o,s=this.parseParameters(e,r,n);switch(i.toLowerCase()){case"phong":o=new THREE.MeshPhongMaterial;break;case"lambert":o=new THREE.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',i),o=new THREE.MeshPhongMaterial}return o.setValues(s),o.name=a,o},parseParameters:function(e,r,n){var a={};e.BumpFactor&&(a.bumpScale=e.BumpFactor.value),e.Diffuse?a.color=(new THREE.Color).fromArray(e.Diffuse.value):e.DiffuseColor&&"Color"===e.DiffuseColor.type&&(a.color=(new THREE.Color).fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(a.displacementScale=e.DisplacementFactor.value),e.Emissive?a.emissive=(new THREE.Color).fromArray(e.Emissive.value):e.EmissiveColor&&"Color"===e.EmissiveColor.type&&(a.emissive=(new THREE.Color).fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(a.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(a.opacity=parseFloat(e.Opacity.value)),a.opacity<1&&(a.transparent=!0),e.ReflectionFactor&&(a.reflectivity=e.ReflectionFactor.value),e.Shininess&&(a.shininess=e.Shininess.value),e.Specular?a.specular=(new THREE.Color).fromArray(e.Specular.value):e.SpecularColor&&"Color"===e.SpecularColor.type&&(a.specular=(new THREE.Color).fromArray(e.SpecularColor.value));var i=this;return t.get(n).children.forEach(function(e){var t=e.relationship;switch(t){case"Bump":a.bumpMap=i.getTexture(r,e.ID);break;case"Maya|TEX_ao_map":a.aoMap=i.getTexture(r,e.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":a.map=i.getTexture(r,e.ID),a.map.encoding=THREE.sRGBEncoding;break;case"DisplacementColor":a.displacementMap=i.getTexture(r,e.ID);break;case"EmissiveColor":a.emissiveMap=i.getTexture(r,e.ID),a.emissiveMap.encoding=THREE.sRGBEncoding;break;case"NormalMap":case"Maya|TEX_normal_map":a.normalMap=i.getTexture(r,e.ID);break;case"ReflectionColor":a.envMap=i.getTexture(r,e.ID),a.envMap.mapping=THREE.EquirectangularReflectionMapping,a.envMap.encoding=THREE.sRGBEncoding;break;case"SpecularColor":a.specularMap=i.getTexture(r,e.ID),a.specularMap.encoding=THREE.sRGBEncoding;break;case"TransparentColor":a.alphaMap=i.getTexture(r,e.ID),a.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",t)}}),a},getTexture:function(r,n){return"LayeredTexture"in e.Objects&&n in e.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),n=t.get(n).children[0].ID),r.get(n)},parseDeformers:function(){var r={},n={};if("Deformer"in e.Objects){var a=e.Objects.Deformer;for(var i in a){var o=a[i],s=t.get(parseInt(i));if("Skin"===o.attrType){var l=this.parseSkeleton(s,a);l.ID=i,s.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),l.geometryID=s.parents[0].ID,r[i]=l}else if("BlendShape"===o.attrType){var u={id:i};u.rawTargets=this.parseMorphTargets(s,a),u.id=i,s.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),n[i]=u}}}return{skeletons:r,morphTargets:n}},parseSkeleton:function(e,t){var r=[];return e.children.forEach(function(e){var n=t[e.ID];if("Cluster"===n.attrType){var a={ID:e.ID,indices:[],weights:[],transformLink:(new THREE.Matrix4).fromArray(n.TransformLink.a)};"Indexes"in n&&(a.indices=n.Indexes.a,a.weights=n.Weights.a),r.push(a)}}),{rawBones:r,bones:[]}},parseMorphTargets:function(e,r){for(var n=[],a=0;a<e.children.length;a++){var i=e.children[a],o=r[i.ID],s={name:o.attrName,initialWeight:o.DeformPercent,id:o.id,fullWeights:o.FullWeights.a};if("BlendShapeChannel"!==o.attrType)return;s.geoID=t.get(parseInt(i.ID)).children.filter(function(e){return void 0===e.relationship})[0].ID,n.push(s)}return n},parseScene:function(n,a,i){r=new THREE.Group;var s=this.parseModels(n.skeletons,a,i),l=e.Objects.Model,u=this;s.forEach(function(e){var n=l[e.ID];u.setLookAtProperties(e,n),t.get(e.ID).parents.forEach(function(t){var r=s.get(t.ID);void 0!==r&&r.add(e)}),null===e.parent&&r.add(e)}),this.bindSkeleton(n.skeletons,a,s),this.createAmbientLight(),this.setupMorphMaterials(),r.traverse(function(e){if(e.userData.transformData){e.parent&&(e.userData.transformData.parentMatrixWorld=e.parent.matrix);var t=y(e.userData.transformData);e.applyMatrix(t)}});var c=(new o).parse();1===r.children.length&&r.children[0].isGroup&&(r.children[0].animations=c,r=r.children[0]),r.animations=c},parseModels:function(r,n,a){var i=new T.a,o=e.Objects.Model;for(var s in o){var l=parseInt(s),u=o[s],c=t.get(l),p=this.buildSkeleton(c,r,l,u.attrName);if(!p){switch(u.attrType){case"Camera":p=this.createCamera(c);break;case"Light":p=this.createLight(c);break;case"Mesh":p=this.createMesh(c,n,a);break;case"NurbsCurve":p=this.createCurve(c,n);break;case"LimbNode":case"Root":p=new THREE.Bone;break;case"Null":default:p=new THREE.Group}p.name=u.attrName?THREE.PropertyBinding.sanitizeNodeName(u.attrName):"",p.ID=l}this.getTransformData(p,u),i.set(l,p)}return i},buildSkeleton:function(e,t,r,n){var a=null;return e.parents.forEach(function(e){for(var i in t){var o=t[i];o.rawBones.forEach(function(t,i){if(t.ID===e.ID){var s=a;(a=new THREE.Bone).matrixWorld.copy(t.transformLink),a.name=n?THREE.PropertyBinding.sanitizeNodeName(n):"",a.ID=r,o.bones[i]=a,null!==s&&a.add(s)}})}}),a},createCamera:function(t){var r,n;if(t.children.forEach(function(t){var r=e.Objects.NodeAttribute[t.ID];void 0!==r&&(n=r)}),void 0===n)r=new THREE.Object3D;else{var a=0;void 0!==n.CameraProjectionType&&1===n.CameraProjectionType.value&&(a=1);var i=1;void 0!==n.NearPlane&&(i=n.NearPlane.value/1e3);var o=1e3;void 0!==n.FarPlane&&(o=n.FarPlane.value/1e3);var s=window.innerWidth,l=window.innerHeight;void 0!==n.AspectWidth&&void 0!==n.AspectHeight&&(s=n.AspectWidth.value,l=n.AspectHeight.value);var u=s/l,c=45;void 0!==n.FieldOfView&&(c=n.FieldOfView.value);var p=n.FocalLength?n.FocalLength.value:null;switch(a){case 0:r=new THREE.PerspectiveCamera(c,u,i,o),null!==p&&r.setFocalLength(p);break;case 1:r=new THREE.OrthographicCamera(-s/2,s/2,l/2,-l/2,i,o);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+a+"."),r=new THREE.Object3D}}return r},createLight:function(t){var r,n;if(t.children.forEach(function(t){var r=e.Objects.NodeAttribute[t.ID];void 0!==r&&(n=r)}),void 0===n)r=new THREE.Object3D;else{var a;a=void 0===n.LightType?0:n.LightType.value;var i=16777215;void 0!==n.Color&&(i=(new THREE.Color).fromArray(n.Color.value));var o=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(o=0);var s=0;void 0!==n.FarAttenuationEnd&&(s=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value);switch(a){case 0:r=new THREE.PointLight(i,o,s,1);break;case 1:r=new THREE.DirectionalLight(i,o);break;case 2:var l=Math.PI/3;void 0!==n.InnerAngle&&(l=THREE.Math.degToRad(n.InnerAngle.value));var u=0;void 0!==n.OuterAngle&&(u=THREE.Math.degToRad(n.OuterAngle.value),u=Math.max(u,1)),r=new THREE.SpotLight(i,o,s,l,u,1);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a THREE.PointLight."),r=new THREE.PointLight(i,o)}void 0!==n.CastShadows&&1===n.CastShadows.value&&(r.castShadow=!0)}return r},createMesh:function(e,t,r){var n,a=null,i=null,o=[];return e.children.forEach(function(e){t.has(e.ID)&&(a=t.get(e.ID)),r.has(e.ID)&&o.push(r.get(e.ID))}),o.length>1?i=o:o.length>0?i=o[0]:(i=new THREE.MeshPhongMaterial({color:13421772}),o.push(i)),"color"in a.attributes&&o.forEach(function(e){e.vertexColors=THREE.VertexColors}),a.FBX_Deformer?(o.forEach(function(e){e.skinning=!0}),(n=new THREE.SkinnedMesh(a,i)).normalizeSkinWeights()):n=new THREE.Mesh(a,i),n},createCurve:function(e,t){var r=e.children.reduce(function(e,r){return t.has(r.ID)&&(e=t.get(r.ID)),e},null),n=new THREE.LineBasicMaterial({color:3342591,linewidth:1});return new THREE.Line(r,n)},getTransformData:function(e,t){var r={};"InheritType"in t&&(r.inheritType=parseInt(t.InheritType.value)),r.eulerOrder="RotationOrder"in t?w(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(r.translation=t.Lcl_Translation.value),"PreRotation"in t&&(r.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(r.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(r.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(r.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(r.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(r.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(r.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(r.rotationPivot=t.RotationPivot.value),e.userData.transformData=r},setLookAtProperties:function(n,a){"LookAtProperty"in a&&t.get(n.ID).children.forEach(function(t){if("LookAtProperty"===t.relationship){var a=e.Objects.Model[t.ID];if("Lcl_Translation"in a){var i=a.Lcl_Translation.value;void 0!==n.target?(n.target.position.fromArray(i),r.add(n.target)):n.lookAt((new THREE.Vector3).fromArray(i))}}})},bindSkeleton:function(e,r,n){var a=this.parsePoseNodes();for(var i in e){var o=e[i];t.get(parseInt(o.ID)).parents.forEach(function(e){if(r.has(e.ID)){var i=e.ID;t.get(i).parents.forEach(function(e){n.has(e.ID)&&n.get(e.ID).bind(new THREE.Skeleton(o.bones),a[e.ID])})}})}},parsePoseNodes:function(){var t={};if("Pose"in e.Objects){var r=e.Objects.Pose;for(var n in r)if("BindPose"===r[n].attrType){var a=r[n].PoseNode;Array.isArray(a)?a.forEach(function(e){t[e.Node]=(new THREE.Matrix4).fromArray(e.Matrix.a)}):t[a.Node]=(new THREE.Matrix4).fromArray(a.Matrix.a)}}return t},createAmbientLight:function(){if("GlobalSettings"in e&&"AmbientColor"in e.GlobalSettings){var t=e.GlobalSettings.AmbientColor.value,n=t[0],a=t[1],i=t[2];if(0!==n||0!==a||0!==i){var o=new THREE.Color(n,a,i);r.add(new THREE.AmbientLight(o,1))}}},setupMorphMaterials:function(){var e=this;r.traverse(function(t){t.isMesh&&t.geometry.morphAttributes.position&&t.geometry.morphAttributes.position.length&&(Array.isArray(t.material)?t.material.forEach(function(r,n){e.setupMorphMaterial(t,r,n)}):e.setupMorphMaterial(t,t.material))})},setupMorphMaterial:function(e,t,n){var a=e.uuid,i=t.uuid,o=!1;if(r.traverse(function(e){e.isMesh&&(Array.isArray(e.material)?e.material.forEach(function(t){t.uuid===i&&e.uuid!==a&&(o=!0)}):e.material.uuid===i&&e.uuid!==a&&(o=!0))}),!0===o){var s=t.clone();s.morphTargets=!0,void 0===n?e.material=s:e.material[n]=s}else t.morphTargets=!0}},i.prototype={constructor:i,parse:function(r){var n=new T.a;if("Geometry"in e.Objects){var a=e.Objects.Geometry;for(var i in a){var o=t.get(parseInt(i)),s=this.parseGeometry(o,a[i],r);n.set(parseInt(i),s)}}return n},parseGeometry:function(e,t,r){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,r);case"NurbsCurve":return this.parseNurbsGeometry(t)}},parseMeshGeometry:function(t,r,n){var a=n.skeletons,i=[],o=t.parents.map(function(t){return e.Objects.Model[t.ID]});if(0!==o.length){var s=t.children.reduce(function(e,t){return void 0!==a[t.ID]&&(e=a[t.ID]),e},null);t.children.forEach(function(e){void 0!==n.morphTargets[e.ID]&&i.push(n.morphTargets[e.ID])});var l=o[0],u={};"RotationOrder"in l&&(u.eulerOrder=w(l.RotationOrder.value)),"InheritType"in l&&(u.inheritType=parseInt(l.InheritType.value)),"GeometricTranslation"in l&&(u.translation=l.GeometricTranslation.value),"GeometricRotation"in l&&(u.rotation=l.GeometricRotation.value),"GeometricScaling"in l&&(u.scale=l.GeometricScaling.value);var c=y(u);return this.genGeometry(r,s,i,c)}},genGeometry:function(e,t,r,n){var a=new THREE.BufferGeometry;e.attrName&&(a.name=e.attrName);var i=this.parseGeoNode(e,t),o=this.genBuffers(i),s=new THREE.Float32BufferAttribute(o.vertex,3);if(s.applyMatrix4(n),a.setAttribute("position",s),o.colors.length>0&&a.setAttribute("color",new THREE.Float32BufferAttribute(o.colors,3)),t&&(a.setAttribute("skinIndex",new THREE.Uint16BufferAttribute(o.weightsIndices,4)),a.setAttribute("skinWeight",new THREE.Float32BufferAttribute(o.vertexWeights,4)),a.FBX_Deformer=t),o.normal.length>0){var l=(new THREE.Matrix3).getNormalMatrix(n),u=new THREE.Float32BufferAttribute(o.normal,3);u.applyNormalMatrix(l),a.setAttribute("normal",u)}if(o.uvs.forEach(function(e,t){var r="uv"+(t+1).toString();0===t&&(r="uv"),a.setAttribute(r,new THREE.Float32BufferAttribute(o.uvs[t],2))}),i.material&&"AllSame"!==i.material.mappingType){var c=o.materialIndex[0],p=0;if(o.materialIndex.forEach(function(e,t){e!==c&&(a.addGroup(p,t-p,c),c=e,p=t)}),a.groups.length>0){var h=a.groups[a.groups.length-1],f=h.start+h.count;f!==o.materialIndex.length&&a.addGroup(f,o.materialIndex.length-f,c)}0===a.groups.length&&a.addGroup(0,o.materialIndex.length,o.materialIndex[0])}return this.addMorphTargets(a,e,r,n),a},parseGeoNode:function(e,t){var r={};if(r.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],r.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(r.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(r.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(r.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){r.uv=[];for(var n=0;e.LayerElementUV[n];)r.uv.push(this.parseUVs(e.LayerElementUV[n])),n++}return r.weightTable={},null!==t&&(r.skeleton=t,t.rawBones.forEach(function(e,t){e.indices.forEach(function(n,a){void 0===r.weightTable[n]&&(r.weightTable[n]=[]),r.weightTable[n].push({id:t,weight:e.weights[a]})})})),r},genBuffers:function(e){var t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},r=0,n=0,a=!1,i=[],o=[],s=[],l=[],u=[],c=[],p=this;return e.vertexIndices.forEach(function(h,f){var d=!1;h<0&&(h^=-1,d=!0);var m=[],g=[];if(i.push(3*h,3*h+1,3*h+2),e.color){var E=v(f,r,h,e.color);s.push(E[0],E[1],E[2])}if(e.skeleton){if(void 0!==e.weightTable[h]&&e.weightTable[h].forEach(function(e){g.push(e.weight),m.push(e.id)}),g.length>4){a||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),a=!0);var T=[0,0,0,0],y=[0,0,0,0];g.forEach(function(e,t){var r=e,n=m[t];y.forEach(function(e,t,a){if(r>e){a[t]=r,r=e;var i=T[t];T[t]=n,n=i}})}),m=T,g=y}for(;g.length<4;)g.push(0),m.push(0);for(var R=0;R<4;++R)u.push(g[R]),c.push(m[R])}if(e.normal){E=v(f,r,h,e.normal);o.push(E[0],E[1],E[2])}if(e.material&&"AllSame"!==e.material.mappingType)var w=v(f,r,h,e.material)[0];e.uv&&e.uv.forEach(function(e,t){var n=v(f,r,h,e);void 0===l[t]&&(l[t]=[]),l[t].push(n[0]),l[t].push(n[1])}),n++,d&&(p.genFace(t,e,i,w,o,s,l,u,c,n),r++,n=0,i=[],o=[],s=[],l=[],u=[],c=[])}),t},genFace:function(e,t,r,n,a,i,o,s,l,u){for(var c=2;c<u;c++)e.vertex.push(t.vertexPositions[r[0]]),e.vertex.push(t.vertexPositions[r[1]]),e.vertex.push(t.vertexPositions[r[2]]),e.vertex.push(t.vertexPositions[r[3*(c-1)]]),e.vertex.push(t.vertexPositions[r[3*(c-1)+1]]),e.vertex.push(t.vertexPositions[r[3*(c-1)+2]]),e.vertex.push(t.vertexPositions[r[3*c]]),e.vertex.push(t.vertexPositions[r[3*c+1]]),e.vertex.push(t.vertexPositions[r[3*c+2]]),t.skeleton&&(e.vertexWeights.push(s[0]),e.vertexWeights.push(s[1]),e.vertexWeights.push(s[2]),e.vertexWeights.push(s[3]),e.vertexWeights.push(s[4*(c-1)]),e.vertexWeights.push(s[4*(c-1)+1]),e.vertexWeights.push(s[4*(c-1)+2]),e.vertexWeights.push(s[4*(c-1)+3]),e.vertexWeights.push(s[4*c]),e.vertexWeights.push(s[4*c+1]),e.vertexWeights.push(s[4*c+2]),e.vertexWeights.push(s[4*c+3]),e.weightsIndices.push(l[0]),e.weightsIndices.push(l[1]),e.weightsIndices.push(l[2]),e.weightsIndices.push(l[3]),e.weightsIndices.push(l[4*(c-1)]),e.weightsIndices.push(l[4*(c-1)+1]),e.weightsIndices.push(l[4*(c-1)+2]),e.weightsIndices.push(l[4*(c-1)+3]),e.weightsIndices.push(l[4*c]),e.weightsIndices.push(l[4*c+1]),e.weightsIndices.push(l[4*c+2]),e.weightsIndices.push(l[4*c+3])),t.color&&(e.colors.push(i[0]),e.colors.push(i[1]),e.colors.push(i[2]),e.colors.push(i[3*(c-1)]),e.colors.push(i[3*(c-1)+1]),e.colors.push(i[3*(c-1)+2]),e.colors.push(i[3*c]),e.colors.push(i[3*c+1]),e.colors.push(i[3*c+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(n),e.materialIndex.push(n),e.materialIndex.push(n)),t.normal&&(e.normal.push(a[0]),e.normal.push(a[1]),e.normal.push(a[2]),e.normal.push(a[3*(c-1)]),e.normal.push(a[3*(c-1)+1]),e.normal.push(a[3*(c-1)+2]),e.normal.push(a[3*c]),e.normal.push(a[3*c+1]),e.normal.push(a[3*c+2])),t.uv&&t.uv.forEach(function(t,r){void 0===e.uvs[r]&&(e.uvs[r]=[]),e.uvs[r].push(o[r][0]),e.uvs[r].push(o[r][1]),e.uvs[r].push(o[r][2*(c-1)]),e.uvs[r].push(o[r][2*(c-1)+1]),e.uvs[r].push(o[r][2*c]),e.uvs[r].push(o[r][2*c+1])})},addMorphTargets:function(t,r,n,a){if(0!==n.length){t.morphTargetsRelative=!0,t.morphAttributes.position=[];var i=this;n.forEach(function(n){n.rawTargets.forEach(function(n){var o=e.Objects.Geometry[n.geoID];void 0!==o&&i.genMorphGeometry(t,r,o,a,n.name)})})}},genMorphGeometry:function(e,t,r,n,a){for(var i=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],o=void 0!==r.Vertices?r.Vertices.a:[],s=void 0!==r.Indexes?r.Indexes.a:[],l=3*e.attributes.position.count,u=new Float32Array(l),c=0;c<s.length;c++){var p=3*s[c];u[p]=o[3*c],u[p+1]=o[3*c+1],u[p+2]=o[3*c+2]}var h={vertexIndices:i,vertexPositions:u},f=this.genBuffers(h),d=new THREE.Float32BufferAttribute(f.vertex,3);d.name=a||r.attrName,d.applyMatrix4(n),e.morphAttributes.position.push(d)},parseNormals:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.Normals.a,a=[];return"IndexToDirect"===r&&("NormalIndex"in e?a=e.NormalIndex.a:"NormalsIndex"in e&&(a=e.NormalsIndex.a)),{dataSize:3,buffer:n,indices:a,mappingType:t,referenceType:r}},parseUVs:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.UV.a,a=[];return"IndexToDirect"===r&&(a=e.UVIndex.a),{dataSize:2,buffer:n,indices:a,mappingType:t,referenceType:r}},parseVertexColors:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.Colors.a,a=[];return"IndexToDirect"===r&&(a=e.ColorIndex.a),{dataSize:4,buffer:n,indices:a,mappingType:t,referenceType:r}},parseMaterialIndices:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:r};for(var n=e.Materials.a,a=[],i=0;i<n.length;++i)a.push(i);return{dataSize:1,buffer:n,indices:a,mappingType:t,referenceType:r}},parseNurbsGeometry:function(e){if(void 0===THREE.NURBSCurve)return console.error("THREE.FBXLoader: The loader relies on THREE.NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new THREE.BufferGeometry;var t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new THREE.BufferGeometry;for(var r,n,a=t-1,i=e.KnotVector.a,o=[],s=e.Points.a,l=0,u=s.length;l<u;l+=4)o.push((new THREE.Vector4).fromArray(s,l));if("Closed"===e.Form)o.push(o[0]);else if("Periodic"===e.Form){r=a,n=i.length-1-r;for(l=0;l<a;++l)o.push(o[l])}var c=new THREE.NURBSCurve(a,i,o,r,n).getPoints(7*o.length),p=new Float32Array(3*c.length);c.forEach(function(e,t){e.toArray(p,3*t)});var h=new THREE.BufferGeometry;return h.setAttribute("position",new THREE.BufferAttribute(p,3)),h}},o.prototype={constructor:o,parse:function(){var e=[],t=this.parseClips();if(void 0!==t)for(var r in t){var n=t[r],a=this.addClip(n);e.push(a)}return e},parseClips:function(){if(void 0!==e.Objects.AnimationCurve){var t=this.parseAnimationCurveNodes();this.parseAnimationCurves(t);var r=this.parseAnimationLayers(t);return this.parseAnimStacks(r)}},parseAnimationCurveNodes:function(){var t=e.Objects.AnimationCurveNode,r=new T.a;for(var n in t){var a=t[n];if(null!==a.attrName.match(/S|R|T|DeformPercent/)){var i={id:a.id,attr:a.attrName,curves:{}};r.set(i.id,i)}}return r},parseAnimationCurves:function(r){var n=e.Objects.AnimationCurve;for(var a in n){var i={id:n[a].id,times:n[a].KeyTime.a.map(f),values:n[a].KeyValueFloat.a},o=t.get(i.id);if(void 0!==o){var s=o.parents[0].ID,l=o.parents[0].relationship;l.match(/X/)?r.get(s).curves.x=i:l.match(/Y/)?r.get(s).curves.y=i:l.match(/Z/)?r.get(s).curves.z=i:l.match(/d|DeformPercent/)&&r.has(s)&&(r.get(s).curves.morph=i)}}},parseAnimationLayers:function(n){var a=e.Objects.AnimationLayer,i=new T.a;for(var o in a){var s=[],l=t.get(parseInt(o));if(void 0!==l)l.children.forEach(function(a,i){if(n.has(a.ID)){var o=n.get(a.ID);if(void 0!==o.curves.x||void 0!==o.curves.y||void 0!==o.curves.z){if(void 0===s[i])if(void 0!==(f=t.get(a.ID).parents.filter(function(e){return void 0!==e.relationship})[0].ID)){var l={modelName:(u=e.Objects.Model[f.toString()]).attrName?THREE.PropertyBinding.sanitizeNodeName(u.attrName):"",ID:u.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};r.traverse(function(e){e.ID===u.id&&(l.transform=e.matrix,e.userData.transformData&&(l.eulerOrder=e.userData.transformData.eulerOrder))}),l.transform||(l.transform=new THREE.Matrix4),"PreRotation"in u&&(l.preRotation=u.PreRotation.value),"PostRotation"in u&&(l.postRotation=u.PostRotation.value),s[i]=l}s[i]&&(s[i][o.attr]=o)}else if(void 0!==o.curves.morph){if(void 0===s[i]){var u,c=t.get(a.ID).parents.filter(function(e){return void 0!==e.relationship})[0].ID,p=t.get(c).parents[0].ID,h=t.get(p).parents[0].ID,f=t.get(h).parents[0].ID;l={modelName:(u=e.Objects.Model[f]).attrName?THREE.PropertyBinding.sanitizeNodeName(u.attrName):"",morphName:e.Objects.Deformer[c].attrName};s[i]=l}s[i][o.attr]=o}}}),i.set(parseInt(o),s)}return i},parseAnimStacks:function(r){var n=e.Objects.AnimationStack,a={};for(var i in n){var o=t.get(parseInt(i)).children;o.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var s=r.get(o[0].ID);a[i]={name:n[i].attrName,layer:s}}return a},addClip:function(e){var t=[],r=this;return e.layer.forEach(function(e){t=t.concat(r.generateTracks(e))}),new THREE.AnimationClip(e.name,-1,t)},generateTracks:function(e){var t=[],r=new THREE.Vector3,n=new THREE.Quaternion,a=new THREE.Vector3;if(e.transform&&e.transform.decompose(r,n,a),r=r.toArray(),n=(new THREE.Euler).setFromQuaternion(n,e.eulerOrder).toArray(),a=a.toArray(),void 0!==e.T&&u()(e.T.curves).length>0){var i=this.generateVectorTrack(e.modelName,e.T.curves,r,"position");void 0!==i&&t.push(i)}if(void 0!==e.R&&u()(e.R.curves).length>0){var o=this.generateRotationTrack(e.modelName,e.R.curves,n,e.preRotation,e.postRotation,e.eulerOrder);void 0!==o&&t.push(o)}if(void 0!==e.S&&u()(e.S.curves).length>0){var s=this.generateVectorTrack(e.modelName,e.S.curves,a,"scale");void 0!==s&&t.push(s)}if(void 0!==e.DeformPercent){var l=this.generateMorphTrack(e);void 0!==l&&t.push(l)}return t},generateVectorTrack:function(e,t,r,n){var a=this.getTimesForAllAxes(t),i=this.getKeyframeTrackValues(a,t,r);return new THREE.VectorKeyframeTrack(e+"."+n,a,i)},generateRotationTrack:function(e,t,r,n,a,i){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(THREE.Math.degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(THREE.Math.degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(THREE.Math.degToRad));var o=this.getTimesForAllAxes(t),s=this.getKeyframeTrackValues(o,t,r);void 0!==n&&((n=n.map(THREE.Math.degToRad)).push(i),n=(new THREE.Euler).fromArray(n),n=(new THREE.Quaternion).setFromEuler(n)),void 0!==a&&((a=a.map(THREE.Math.degToRad)).push(i),a=(new THREE.Euler).fromArray(a),a=(new THREE.Quaternion).setFromEuler(a).inverse());for(var l=new THREE.Quaternion,u=new THREE.Euler,c=[],p=0;p<s.length;p+=3)u.set(s[p],s[p+1],s[p+2],i),l.setFromEuler(u),void 0!==n&&l.premultiply(n),void 0!==a&&l.multiply(a),l.toArray(c,p/3*4);return new THREE.QuaternionKeyframeTrack(e+".quaternion",o,c)},generateMorphTrack:function(e){var t=e.DeformPercent.curves.morph,n=t.values.map(function(e){return e/100}),a=r.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new THREE.NumberKeyframeTrack(e.modelName+".morphTargetInfluences["+a+"]",t.times,n)},getTimesForAllAxes:function(e){var t=[];return void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort(function(e,t){return e-t}).filter(function(e,t,r){return r.indexOf(e)==t})},getKeyframeTrackValues:function(e,t,r){var n=r,a=[],i=-1,o=-1,s=-1;return e.forEach(function(e){if(t.x&&(i=t.x.times.indexOf(e)),t.y&&(o=t.y.times.indexOf(e)),t.z&&(s=t.z.times.indexOf(e)),-1!==i){var r=t.x.values[i];a.push(r),n[0]=r}else a.push(n[0]);if(-1!==o){var l=t.y.values[o];a.push(l),n[1]=l}else a.push(n[1]);if(-1!==s){var u=t.z.values[s];a.push(u),n[2]=u}else a.push(n[2])}),a},interpolateRotations:function(e){for(var t=1;t<e.values.length;t++){var r=e.values[t-1],n=e.values[t]-r,a=Math.abs(n);if(a>=180){for(var i=a/180,o=n/i,s=r+o,l=e.times[t-1],u=(e.times[t]-l)/i,c=l+u,p=[],h=[];c<e.times[t];)p.push(c),c+=u,h.push(s),s+=o;e.times=S(e.times,t,p),e.values=S(e.values,t,h)}}}},s.prototype={constructor:s,getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(e){this.nodeStack.push(e),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(e,t){this.currentProp=e,this.currentPropName=t},parse:function(e){this.currentIndent=0,this.allNodes=new p,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var t=this,r=e.split(/[\r\n]+/);return r.forEach(function(e,n){var a=e.match(/^[\s\t]*;/),i=e.match(/^[\s\t]*$/);if(!a&&!i){var o=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),s=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),l=e.match("^\\t{"+(t.currentIndent-1)+"}}");o?t.parseNodeBegin(e,o):s?t.parseNodeProperty(e,s,r[++n]):l?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)}}),this.allNodes},parseNodeBegin:function(e,t){var r=t[1].trim().replace(/^"/,"").replace(/"$/,""),n=t[2].split(",").map(function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")}),a={name:r},i=this.parseNodeAttr(n),o=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(r,a):r in o?("PoseNode"===r?o.PoseNode.push(a):void 0!==o[r].id&&(o[r]={},o[r][o[r].id]=o[r]),""!==i.id&&(o[r][i.id]=a)):"number"==typeof i.id?(o[r]={},o[r][i.id]=a):"Properties70"!==r&&(o[r]="PoseNode"===r?[a]:a),"number"==typeof i.id&&(a.id=i.id),""!==i.name&&(a.attrName=i.name),""!==i.type&&(a.attrType=i.type),this.pushStack(a)},parseNodeAttr:function(e){var t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));var r="",n="";return e.length>1&&(r=e[1].replace(/^(\w+)::/,""),n=e[2]),{id:t,name:r,type:n}},parseNodeProperty:function(e,t,r){var n=t[1].replace(/^"/,"").replace(/"$/,"").trim(),a=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===n&&","===a&&(a=r.replace(/"/g,"").replace(/,$/,"").trim());var i=this.getCurrentNode();if("Properties70"!==i.name){if("C"===n){var o=a.split(",").slice(1),s=parseInt(o[0]),l=parseInt(o[1]),u=a.split(",").slice(3);n="connections",function(e,t){for(var r=0,n=e.length,a=t.length;r<a;r++,n++)e[n]=t[r]}(a=[s,l],u=u.map(function(e){return e.trim().replace(/^"/,"")})),void 0===i[n]&&(i[n]=[])}"Node"===n&&(i.id=a),n in i&&Array.isArray(i[n])?i[n].push(a):"a"!==n?i[n]=a:i.a=a,this.setCurrentProp(i,n),"a"===n&&","!==a.slice(-1)&&(i.a=b(a))}else this.parseNodeSpecialProperty(e,n,a)},parseNodePropertyContinued:function(e){var t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=b(t.a))},parseNodeSpecialProperty:function(e,t,r){var n=r.split('",').map(function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")}),a=n[0],i=n[1],o=n[2],s=n[3],l=n[4];switch(i){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":l=parseFloat(l);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":l=b(l)}this.getPrevNode()[a]={type:i,type2:o,flag:s,value:l},this.setCurrentProp(this.getPrevNode(),a)}},l.prototype={constructor:l,parse:function(e){var t=new c(e);t.skip(23);var r=t.getUint32();console.log("THREE.FBXLoader: FBX binary version: "+r);for(var n=new p;!this.endOfContent(t);){var a=this.parseNode(t,r);null!==a&&n.add(a.name,a)}return n},endOfContent:function(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()},parseNode:function(e,t){var r={},n=t>=7500?e.getUint64():e.getUint32(),a=t>=7500?e.getUint64():e.getUint32(),i=(t>=7500?e.getUint64():e.getUint32(),e.getUint8()),o=e.getString(i);if(0===n)return null;for(var s=[],l=0;l<a;l++)s.push(this.parseProperty(e));var u=s.length>0?s[0]:"",c=s.length>1?s[1]:"",p=s.length>2?s[2]:"";for(r.singleProperty=1===a&&e.getOffset()===n;n>e.getOffset();){var h=this.parseNode(e,t);null!==h&&this.parseSubNode(o,r,h)}return r.propertyList=s,"number"==typeof u&&(r.id=u),""!==c&&(r.attrName=c),""!==p&&(r.attrType=p),""!==o&&(r.name=o),r},parseSubNode:function(e,t,r){if(!0===r.singleProperty){var n=r.propertyList[0];Array.isArray(n)?(t[r.name]=r,r.a=n):t[r.name]=n}else if("Connections"===e&&"C"===r.name){var a=[];r.propertyList.forEach(function(e,t){0!==t&&a.push(e)}),void 0===t.connections&&(t.connections=[]),t.connections.push(a)}else if("Properties70"===r.name){u()(r).forEach(function(e){t[e]=r[e]})}else if("Properties70"===e&&"P"===r.name){var i,o=r.propertyList[0],s=r.propertyList[1],l=r.propertyList[2],c=r.propertyList[3];0===o.indexOf("Lcl ")&&(o=o.replace("Lcl ","Lcl_")),0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),i="Color"===s||"ColorRGB"===s||"Vector"===s||"Vector3D"===s||0===s.indexOf("Lcl_")?[r.propertyList[4],r.propertyList[5],r.propertyList[6]]:r.propertyList[4],t[o]={type:s,type2:l,flag:c,value:i}}else void 0===t[r.name]?"number"==typeof r.id?(t[r.name]={},t[r.name][r.id]=r):t[r.name]=r:"PoseNode"===r.name?(Array.isArray(t[r.name])||(t[r.name]=[t[r.name]]),t[r.name].push(r)):void 0===t[r.name][r.id]&&(t[r.name][r.id]=r)},parseProperty:function(e){var t=e.getString(1);switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":var r=e.getUint32();return e.getArrayBuffer(r);case"S":r=e.getUint32();return e.getString(r);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var n=e.getUint32(),a=e.getUint32(),i=e.getUint32();if(0===a)switch(t){case"b":case"c":return e.getBooleanArray(n);case"d":return e.getFloat64Array(n);case"f":return e.getFloat32Array(n);case"i":return e.getInt32Array(n);case"l":return e.getInt64Array(n)}void 0===THREE.Zlib&&console.error("THREE.FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var o=new c(new THREE.Zlib.Inflate(new Uint8Array(e.getArrayBuffer(i))).decompress().buffer);switch(t){case"b":case"c":return o.getBooleanArray(n);case"d":return o.getFloat64Array(n);case"f":return o.getFloat32Array(n);case"i":return o.getInt32Array(n);case"l":return o.getInt64Array(n)}default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}},c.prototype={constructor:c,getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(e){this.offset+=e},getBoolean:function(){return 1==(1&this.getUint8())},getBooleanArray:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getBoolean());return t},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getInt16:function(){var e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},getInt32:function(){var e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},getInt32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt32());return t},getUint32:function(){var e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},getInt64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,4294967295===(e=4294967295&~e)&&(t=t+1&4294967295),-(4294967296*t+(e=e+1&4294967295))):4294967296*t+e},getInt64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt64());return t},getUint64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e},getFloat32:function(){var e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat64());return t},getArrayBuffer:function(e){var t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},getString:function(e){for(var t=[],r=0;r<e;r++)t[r]=this.getUint8();var n=t.indexOf(0);return n>=0&&(t=t.slice(0,n)),THREE.LoaderUtils.decodeText(new Uint8Array(t))}},p.prototype={constructor:p,add:function(e,t){this[e]=t}};var d=[];function v(e,t,r,n){var a;switch(n.mappingType){case"ByPolygonVertex":a=e;break;case"ByPolygon":a=t;break;case"ByVertice":a=r;break;case"AllSame":a=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}"IndexToDirect"===n.referenceType&&(a=n.indices[a]);var i=a*n.dataSize,o=i+n.dataSize;return function(e,t,r,n){for(var a=r,i=0;a<n;a++,i++)e[i]=t[a];return e}(d,n.buffer,i,o)}var m=new THREE.Euler,E=new THREE.Vector3;function y(e){var t,r=new THREE.Matrix4,n=new THREE.Matrix4,a=new THREE.Matrix4,i=new THREE.Matrix4,o=new THREE.Matrix4,s=new THREE.Matrix4,l=new THREE.Matrix4,u=new THREE.Matrix4,c=new THREE.Matrix4,p=new THREE.Matrix4,h=new THREE.Matrix4,f=e.inheritType?e.inheritType:0;(e.translation&&r.setPosition(E.fromArray(e.translation)),e.preRotation)&&((t=e.preRotation.map(THREE.Math.degToRad)).push(e.eulerOrder),n.makeRotationFromEuler(m.fromArray(t)));e.rotation&&((t=e.rotation.map(THREE.Math.degToRad)).push(e.eulerOrder),a.makeRotationFromEuler(m.fromArray(t)));e.postRotation&&((t=e.postRotation.map(THREE.Math.degToRad)).push(e.eulerOrder),i.makeRotationFromEuler(m.fromArray(t)));e.scale&&o.scale(E.fromArray(e.scale)),e.scalingOffset&&l.setPosition(E.fromArray(e.scalingOffset)),e.scalingPivot&&s.setPosition(E.fromArray(e.scalingPivot)),e.rotationOffset&&u.setPosition(E.fromArray(e.rotationOffset)),e.rotationPivot&&c.setPosition(E.fromArray(e.rotationPivot)),e.parentMatrixWorld&&(p=e.parentMatrixWorld);var d=n.multiply(a).multiply(i),v=new THREE.Matrix4;p.extractRotation(v);var g,T,y,R,w=new THREE.Matrix4;if(w.copyPosition(p),y=w.getInverse(w).multiply(p),T=v.getInverse(v).multiply(y),g=o,0===f)R=v.multiply(d).multiply(T).multiply(g);else if(1===f)R=v.multiply(T).multiply(d).multiply(g);else{var M=(new THREE.Matrix4).copy(o),b=T.multiply(M.getInverse(M));R=v.multiply(d).multiply(b).multiply(g)}var x=r.multiply(u).multiply(c).multiply(n).multiply(a).multiply(i).multiply(c.getInverse(c)).multiply(l).multiply(s).multiply(o).multiply(s.getInverse(s)),S=(new THREE.Matrix4).copyPosition(x),H=p.multiply(S);return h.copyPosition(H),x=h.multiply(R)}function w(e){var t=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(e=e||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),t[0]):t[e]}function b(e){return e.split(",").map(function(e){return parseFloat(e)})}function x(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=e.byteLength),THREE.LoaderUtils.decodeText(new Uint8Array(e,t,r))}function S(e,t,r){return e.slice(0,t).concat(r).concat(e.slice(t))}return n}(),x=r("DZOf"),S=r("Ui/T"),H=(r("ypEA"),r("8yxd"),function(){function e(e){THREE.Loader.call(this,e),this.dracoLoader=null,this.ddsLoader=null}e.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:e,load:function(e,t,r,n){var a,i=this;a=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:THREE.LoaderUtils.extractUrlBase(e),i.manager.itemStart(e);var o=function(t){n?n(t):console.error(t),i.manager.itemError(e),i.manager.itemEnd(e)},s=new THREE.FileLoader(i.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),"use-credentials"===i.crossOrigin&&s.setWithCredentials(!0),s.load(e,function(r){try{i.parse(r,a,function(r){t(r),i.manager.itemEnd(e)},o)}catch(e){o(e)}},r,o)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},parse:function(e,h,f,d){var v,m={};if("string"==typeof e)v=e;else if(THREE.LoaderUtils.decodeText(new Uint8Array(e,0,4))===i){try{m[t.KHR_BINARY_GLTF]=new function(e){this.name=t.KHR_BINARY_GLTF,this.content=null,this.body=null;var r=new DataView(e,0,o);if(this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:r.getUint32(4,!0),length:r.getUint32(8,!0)},this.header.magic!==i)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");var n=new DataView(e,o),a=0;for(;a<n.byteLength;){var l=n.getUint32(a,!0);a+=4;var u=n.getUint32(a,!0);if(a+=4,u===s.JSON){var c=new Uint8Array(e,o+a,l);this.content=THREE.LoaderUtils.decodeText(c)}else if(u===s.BIN){var p=o+a;this.body=e.slice(p,p+l)}a+=l}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}(e)}catch(e){return void(d&&d(e))}v=m[t.KHR_BINARY_GLTF].content}else v=THREE.LoaderUtils.decodeText(new Uint8Array(e));var g=JSON.parse(v);if(void 0===g.asset||g.asset.version[0]<2)d&&d(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{if(g.extensionsUsed)for(var E=0;E<g.extensionsUsed.length;++E){var T=g.extensionsUsed[E],y=g.extensionsRequired||[];switch(T){case t.KHR_LIGHTS_PUNCTUAL:m[T]=new n(g);break;case t.KHR_MATERIALS_UNLIT:m[T]=new a;break;case t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:m[T]=new c;break;case t.KHR_DRACO_MESH_COMPRESSION:m[T]=new l(g,this.dracoLoader);break;case t.MSFT_TEXTURE_DDS:m[T]=new r(this.ddsLoader);break;case t.KHR_TEXTURE_TRANSFORM:m[T]=new u;break;case t.KHR_MESH_QUANTIZATION:m[T]=new p;break;default:y.indexOf(T)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+T+'".')}}new D(g,m,{path:h||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(f,d)}}});var t={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function r(e){if(!e)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=t.MSFT_TEXTURE_DDS,this.ddsLoader=e}function n(e){this.name=t.KHR_LIGHTS_PUNCTUAL;var r=e.extensions&&e.extensions[t.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=r.lights||[]}function a(){this.name=t.KHR_MATERIALS_UNLIT}n.prototype.loadLight=function(e){var t,r=this.lightDefs[e],n=new THREE.Color(16777215);void 0!==r.color&&n.fromArray(r.color);var a=void 0!==r.range?r.range:0;switch(r.type){case"directional":(t=new THREE.DirectionalLight(n)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new THREE.PointLight(n)).distance=a;break;case"spot":(t=new THREE.SpotLight(n)).distance=a,r.spot=r.spot||{},r.spot.innerConeAngle=void 0!==r.spot.innerConeAngle?r.spot.innerConeAngle:0,r.spot.outerConeAngle=void 0!==r.spot.outerConeAngle?r.spot.outerConeAngle:Math.PI/4,t.angle=r.spot.outerConeAngle,t.penumbra=1-r.spot.innerConeAngle/r.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+r.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==r.intensity&&(t.intensity=r.intensity),t.name=r.name||"light_"+e,Promise.resolve(t)},a.prototype.getMaterialType=function(){return THREE.MeshBasicMaterial},a.prototype.extendParams=function(e,t,r){var n=[];e.color=new THREE.Color(1,1,1),e.opacity=1;var a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){var i=a.baseColorFactor;e.color.fromArray(i),e.opacity=i[3]}void 0!==a.baseColorTexture&&n.push(r.assignTexture(e,"map",a.baseColorTexture))}return Promise.all(n)};var i="glTF",o=12,s={JSON:1313821514,BIN:5130562};function l(e,r){if(!r)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=t.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=r,this.dracoLoader.preload()}function u(){this.name=t.KHR_TEXTURE_TRANSFORM}function c(){return{name:t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return THREE.ShaderMaterial},extendParams:function(e,t,r){var n=t.extensions[this.name],a=THREE.ShaderLib.standard,i=THREE.UniformsUtils.clone(a.uniforms),o=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),s=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),l=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),u=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),c=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),p=a.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",o).replace("#include <metalnessmap_pars_fragment>",s).replace("#include <roughnessmap_fragment>",l).replace("#include <metalnessmap_fragment>",u).replace("#include <lights_physical_fragment>",c);delete i.roughness,delete i.metalness,delete i.roughnessMap,delete i.metalnessMap,i.specular={value:(new THREE.Color).setHex(1118481)},i.glossiness={value:.5},i.specularMap={value:null},i.glossinessMap={value:null},e.vertexShader=a.vertexShader,e.fragmentShader=p,e.uniforms=i,e.defines={STANDARD:""},e.color=new THREE.Color(1,1,1),e.opacity=1;var h=[];if(Array.isArray(n.diffuseFactor)){var f=n.diffuseFactor;e.color.fromArray(f),e.opacity=f[3]}if(void 0!==n.diffuseTexture&&h.push(r.assignTexture(e,"map",n.diffuseTexture)),e.emissive=new THREE.Color(0,0,0),e.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,e.specular=new THREE.Color(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){var d=n.specularGlossinessTexture;h.push(r.assignTexture(e,"glossinessMap",d)),h.push(r.assignTexture(e,"specularMap",d))}return Promise.all(h)},createMaterial:function(e){var t=new THREE.ShaderMaterial({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;for(var r=this.specularGlossinessParams,n=0,a=r.length;n<a;n++){var i=e[r[n]];t[r[n]]=i&&i.isColor?i.clone():i}return t},refreshUniforms:function(e,t,r,n,a){if(!0===a.isGLTFSpecularGlossinessMaterial){var i,o=a.uniforms,s=a.defines;o.opacity.value=a.opacity,o.diffuse.value.copy(a.color),o.emissive.value.copy(a.emissive).multiplyScalar(a.emissiveIntensity),o.map.value=a.map,o.specularMap.value=a.specularMap,o.alphaMap.value=a.alphaMap,o.lightMap.value=a.lightMap,o.lightMapIntensity.value=a.lightMapIntensity,o.aoMap.value=a.aoMap,o.aoMapIntensity.value=a.aoMapIntensity,a.map?i=a.map:a.specularMap?i=a.specularMap:a.displacementMap?i=a.displacementMap:a.normalMap?i=a.normalMap:a.bumpMap?i=a.bumpMap:a.glossinessMap?i=a.glossinessMap:a.alphaMap?i=a.alphaMap:a.emissiveMap&&(i=a.emissiveMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),o.uvTransform.value.copy(i.matrix)),a.envMap&&(o.envMap.value=a.envMap,o.envMapIntensity.value=a.envMapIntensity,o.flipEnvMap.value=a.envMap.isCubeTexture?-1:1,o.reflectivity.value=a.reflectivity,o.refractionRatio.value=a.refractionRatio,o.maxMipLevel.value=e.properties.get(a.envMap).__maxMipLevel),o.specular.value.copy(a.specular),o.glossiness.value=a.glossiness,o.glossinessMap.value=a.glossinessMap,o.emissiveMap.value=a.emissiveMap,o.bumpMap.value=a.bumpMap,o.normalMap.value=a.normalMap,o.displacementMap.value=a.displacementMap,o.displacementScale.value=a.displacementScale,o.displacementBias.value=a.displacementBias,null!==o.glossinessMap.value&&void 0===s.USE_GLOSSINESSMAP&&(s.USE_GLOSSINESSMAP="",s.USE_ROUGHNESSMAP=""),null===o.glossinessMap.value&&void 0!==s.USE_GLOSSINESSMAP&&(delete s.USE_GLOSSINESSMAP,delete s.USE_ROUGHNESSMAP)}}}}function p(){this.name=t.KHR_MESH_QUANTIZATION}function h(e,t,r,n){THREE.Interpolant.call(this,e,t,r,n)}l.prototype.decodePrimitive=function(e,t){var r=this.json,n=this.dracoLoader,a=e.extensions[this.name].bufferView,i=e.extensions[this.name].attributes,o={},s={},l={};for(var u in i){var c=b[u]||u.toLowerCase();o[c]=i[u]}for(u in e.attributes){c=b[u]||u.toLowerCase();if(void 0!==i[u]){var p=r.accessors[e.attributes[u]],h=y[p.componentType];l[c]=h,s[c]=!0===p.normalized}}return t.getDependency("bufferView",a).then(function(e){return new Promise(function(t){n.decodeDracoFile(e,function(e){for(var r in e.attributes){var n=e.attributes[r],a=s[r];void 0!==a&&(n.normalized=a)}t(e)},o,l)})})},u.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},h.prototype=Object.create(THREE.Interpolant.prototype),h.prototype.constructor=h,h.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,a=e*n*3+n,i=0;i!==n;i++)t[i]=r[a+i];return t},h.prototype.beforeStart_=h.prototype.copySampleValue_,h.prototype.afterEnd_=h.prototype.copySampleValue_,h.prototype.interpolate_=function(e,t,r,n){for(var a=this.resultBuffer,i=this.sampleValues,o=this.valueSize,s=2*o,l=3*o,u=n-t,c=(r-t)/u,p=c*c,h=p*c,f=e*l,d=f-l,v=-2*h+3*p,m=h-p,g=1-v,E=m-p+c,T=0;T!==o;T++){var y=i[d+T+o],R=i[d+T+s]*u,w=i[f+T+o],M=i[f+T]*u;a[T]=g*y+E*R+v*w+m*M}return a};var f=0,d=1,v=2,m=3,g=4,E=5,T=6,y={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},R={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipmapNearestFilter,9985:THREE.LinearMipmapNearestFilter,9986:THREE.NearestMipmapLinearFilter,9987:THREE.LinearMipmapLinearFilter},w={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},M={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},b={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},x={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},S={CUBICSPLINE:void 0,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete},H="OPAQUE",A="MASK",I="BLEND",L={"image/png":THREE.RGBAFormat,"image/jpeg":THREE.RGBFormat};function _(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e)}function P(e,t,r){for(var n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function F(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function C(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var a=t.extras.targetNames;if(e.morphTargetInfluences.length===a.length){e.morphTargetDictionary={};for(r=0,n=a.length;r<n;r++)e.morphTargetDictionary[a[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function N(e){for(var t="",r=Object.keys(e).sort(),n=0,a=r.length;n<a;n++)t+=r[n]+":"+e[r[n]]+";";return t}function D(e,t,r){this.json=e||{},this.extensions=t||{},this.options=r||{},this.cache=new function(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}},this.primitiveCache={},this.textureLoader=new THREE.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new THREE.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function O(e,t,r){var n=t.attributes,a=[];function i(t,n){return r.getDependency("accessor",t).then(function(t){e.setAttribute(n,t)})}for(var o in n){var s=b[o]||o.toLowerCase();s in e.attributes||a.push(i(n[o],s))}if(void 0!==t.indices&&!e.index){var l=r.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});a.push(l)}return F(e,t),function(e,t,r){var n=t.attributes,a=new THREE.Box3;if(void 0!==n.POSITION){var i=(p=r.json.accessors[n.POSITION]).min,o=p.max;if(void 0!==i&&void 0!==o){a.set(new THREE.Vector3(i[0],i[1],i[2]),new THREE.Vector3(o[0],o[1],o[2]));var s=t.targets;if(void 0!==s)for(var l=new THREE.Vector3,u=0,c=s.length;u<c;u++){var p,h=s[u];if(void 0!==h.POSITION)i=(p=r.json.accessors[h.POSITION]).min,o=p.max,void 0!==i&&void 0!==o?(l.setX(Math.max(Math.abs(i[0]),Math.abs(o[0]))),l.setY(Math.max(Math.abs(i[1]),Math.abs(o[1]))),l.setZ(Math.max(Math.abs(i[2]),Math.abs(o[2]))),a.expandByVector(l)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}e.boundingBox=a;var f=new THREE.Sphere;a.getCenter(f.center),f.radius=a.min.distanceTo(a.max)/2,e.boundingSphere=f}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(e,t,r),Promise.all(a).then(function(){return void 0!==t.targets?function(e,t,r){for(var n=!1,a=!1,i=0,o=t.length;i<o&&(void 0!==(u=t[i]).POSITION&&(n=!0),void 0!==u.NORMAL&&(a=!0),!n||!a);i++);if(!n&&!a)return Promise.resolve(e);var s=[],l=[];for(i=0,o=t.length;i<o;i++){var u=t[i];if(n){var c=void 0!==u.POSITION?r.getDependency("accessor",u.POSITION):e.attributes.position;s.push(c)}a&&(c=void 0!==u.NORMAL?r.getDependency("accessor",u.NORMAL):e.attributes.normal,l.push(c))}return Promise.all([Promise.all(s),Promise.all(l)]).then(function(t){var r=t[0],i=t[1];return n&&(e.morphAttributes.position=r),a&&(e.morphAttributes.normal=i),e.morphTargetsRelative=!0,e})}(e,t.targets,r):e})}function k(e,t){var r=e.getIndex();if(null===r){var n=[],a=e.getAttribute("position");if(void 0===a)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var i=0;i<a.count;i++)n.push(i);e.setIndex(n),r=e.getIndex()}var o=r.count-2,s=[];if(t===THREE.TriangleFanDrawMode)for(i=1;i<=o;i++)s.push(r.getX(0)),s.push(r.getX(i)),s.push(r.getX(i+1));else for(i=0;i<o;i++)i%2==0?(s.push(r.getX(i)),s.push(r.getX(i+1)),s.push(r.getX(i+2))):(s.push(r.getX(i+2)),s.push(r.getX(i+1)),s.push(r.getX(i)));s.length/3!==o&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var l=e.clone();return l.setIndex(s),l}return D.prototype.parse=function(e,t){var r=this,n=this.json,a=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(t){var i={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};P(a,i,n),F(i,n),e(i)}).catch(t)},D.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],n={},a={},i=0,o=t.length;i<o;i++)for(var s=t[i].joints,l=0,u=s.length;l<u;l++)e[s[l]].isBone=!0;for(var c=0,p=e.length;c<p;c++){var h=e[c];void 0!==h.mesh&&(void 0===n[h.mesh]&&(n[h.mesh]=a[h.mesh]=0),n[h.mesh]++,void 0!==h.skin&&(r[h.mesh].isSkinnedMesh=!0))}this.json.meshReferences=n,this.json.meshUses=a},D.prototype.getDependency=function(e,r){var n=e+":"+r,a=this.cache.get(n);if(!a){switch(e){case"scene":a=this.loadScene(r);break;case"node":a=this.loadNode(r);break;case"mesh":a=this.loadMesh(r);break;case"accessor":a=this.loadAccessor(r);break;case"bufferView":a=this.loadBufferView(r);break;case"buffer":a=this.loadBuffer(r);break;case"material":a=this.loadMaterial(r);break;case"texture":a=this.loadTexture(r);break;case"skin":a=this.loadSkin(r);break;case"animation":a=this.loadAnimation(r);break;case"camera":a=this.loadCamera(r);break;case"light":a=this.extensions[t.KHR_LIGHTS_PUNCTUAL].loadLight(r);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,a)}return a},D.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map(function(t,n){return r.getDependency(e,n)})),this.cache.add(e,t)}return t},D.prototype.loadBuffer=function(e){var r=this.json.buffers[e],n=this.fileLoader;if(r.type&&"arraybuffer"!==r.type)throw new Error("THREE.GLTFLoader: "+r.type+" buffer type is not supported.");if(void 0===r.uri&&0===e)return Promise.resolve(this.extensions[t.KHR_BINARY_GLTF].body);var a=this.options;return new Promise(function(e,t){n.load(_(r.uri,a.path),e,void 0,function(){t(new Error('THREE.GLTFLoader: Failed to load buffer "'+r.uri+'".'))})})},D.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){var r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)})},D.prototype.loadAccessor=function(e){var t=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse)return Promise.resolve(null);var a=[];return void 0!==n.bufferView?a.push(this.getDependency("bufferView",n.bufferView)):a.push(null),void 0!==n.sparse&&(a.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(a).then(function(e){var a,i,o=e[0],s=M[n.type],l=y[n.componentType],u=l.BYTES_PER_ELEMENT,c=u*s,p=n.byteOffset||0,h=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,f=!0===n.normalized;if(h&&h!==c){var d=Math.floor(p/h),v="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+d+":"+n.count,m=t.cache.get(v);m||(a=new l(o,d*h,n.count*h/u),m=new THREE.InterleavedBuffer(a,h/u),t.cache.add(v,m)),i=new THREE.InterleavedBufferAttribute(m,s,p%h/u,f)}else a=null===o?new l(n.count*s):new l(o,p,n.count*s),i=new THREE.BufferAttribute(a,s,f);if(void 0!==n.sparse){var g=M.SCALAR,E=y[n.sparse.indices.componentType],T=n.sparse.indices.byteOffset||0,R=n.sparse.values.byteOffset||0,w=new E(e[1],T,n.sparse.count*g),b=new l(e[2],R,n.sparse.count*s);null!==o&&(i=new THREE.BufferAttribute(i.array.slice(),i.itemSize,i.normalized));for(var x=0,S=w.length;x<S;x++){var H=w[x];if(i.setX(H,b[x*s]),s>=2&&i.setY(H,b[x*s+1]),s>=3&&i.setZ(H,b[x*s+2]),s>=4&&i.setW(H,b[x*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return i})},D.prototype.loadTexture=function(e){var r,n=this,a=this.json,i=this.options,o=this.textureLoader,s=window.URL||window.webkitURL,l=a.textures[e],u=l.extensions||{},c=(r=u[t.MSFT_TEXTURE_DDS]?a.images[u[t.MSFT_TEXTURE_DDS].source]:a.images[l.source]).uri,p=!1;return void 0!==r.bufferView&&(c=n.getDependency("bufferView",r.bufferView).then(function(e){p=!0;var t=new Blob([e],{type:r.mimeType});return c=s.createObjectURL(t)})),Promise.resolve(c).then(function(e){var r=i.manager.getHandler(e);return r||(r=u[t.MSFT_TEXTURE_DDS]?n.extensions[t.MSFT_TEXTURE_DDS].ddsLoader:o),new Promise(function(t,n){r.load(_(e,i.path),t,void 0,n)})}).then(function(e){!0===p&&s.revokeObjectURL(c),e.flipY=!1,void 0!==l.name&&(e.name=l.name),r.mimeType in L&&(e.format=L[r.mimeType]);var t=(a.samplers||{})[l.sampler]||{};return e.magFilter=R[t.magFilter]||THREE.LinearFilter,e.minFilter=R[t.minFilter]||THREE.LinearMipmapLinearFilter,e.wrapS=w[t.wrapS]||THREE.RepeatWrapping,e.wrapT=w[t.wrapT]||THREE.RepeatWrapping,e})},D.prototype.assignTexture=function(e,r,n){var a=this;return this.getDependency("texture",n.index).then(function(i){if(!i.isCompressedTexture)switch(r){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":i.format=THREE.RGBFormat}if(void 0===n.texCoord||0==n.texCoord||"aoMap"===r&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+r+" not yet supported."),a.extensions[t.KHR_TEXTURE_TRANSFORM]){var o=void 0!==n.extensions?n.extensions[t.KHR_TEXTURE_TRANSFORM]:void 0;o&&(i=a.extensions[t.KHR_TEXTURE_TRANSFORM].extendTexture(i,o))}e[r]=i})},D.prototype.assignFinalMaterial=function(e){var r=e.geometry,n=e.material,a=this.extensions,i=void 0!==r.attributes.tangent,o=void 0!==r.attributes.color,s=void 0===r.attributes.normal,l=!0===e.isSkinnedMesh,u=Object.keys(r.morphAttributes).length>0,c=u&&void 0!==r.morphAttributes.normal;if(e.isPoints){var p="PointsMaterial:"+n.uuid,h=this.cache.get(p);h||(h=new THREE.PointsMaterial,THREE.Material.prototype.copy.call(h,n),h.color.copy(n.color),h.map=n.map,h.sizeAttenuation=!1,this.cache.add(p,h)),n=h}else if(e.isLine){p="LineBasicMaterial:"+n.uuid;var f=this.cache.get(p);f||(f=new THREE.LineBasicMaterial,THREE.Material.prototype.copy.call(f,n),f.color.copy(n.color),this.cache.add(p,f)),n=f}if(i||o||s||l||u){p="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(p+="specular-glossiness:"),l&&(p+="skinning:"),i&&(p+="vertex-tangents:"),o&&(p+="vertex-colors:"),s&&(p+="flat-shading:"),u&&(p+="morph-targets:"),c&&(p+="morph-normals:");var d=this.cache.get(p);d||(d=n.isGLTFSpecularGlossinessMaterial?a[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(n):n.clone(),l&&(d.skinning=!0),i&&(d.vertexTangents=!0),o&&(d.vertexColors=THREE.VertexColors),s&&(d.flatShading=!0),u&&(d.morphTargets=!0),c&&(d.morphNormals=!0),this.cache.add(p,d)),n=d}n.aoMap&&void 0===r.attributes.uv2&&void 0!==r.attributes.uv&&r.setAttribute("uv2",new THREE.BufferAttribute(r.attributes.uv.array,2)),n.isGLTFSpecularGlossinessMaterial&&(e.onBeforeRender=a[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms),n.normalScale&&!i&&(n.normalScale.y=-n.normalScale.y),e.material=n},D.prototype.loadMaterial=function(e){var r,n=this.json,a=this.extensions,i=n.materials[e],o={},s=i.extensions||{},l=[];if(s[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var u=a[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];r=u.getMaterialType(),l.push(u.extendParams(o,i,this))}else if(s[t.KHR_MATERIALS_UNLIT]){var c=a[t.KHR_MATERIALS_UNLIT];r=c.getMaterialType(),l.push(c.extendParams(o,i,this))}else{r=THREE.MeshStandardMaterial;var p=i.pbrMetallicRoughness||{};if(o.color=new THREE.Color(1,1,1),o.opacity=1,Array.isArray(p.baseColorFactor)){var h=p.baseColorFactor;o.color.fromArray(h),o.opacity=h[3]}void 0!==p.baseColorTexture&&l.push(this.assignTexture(o,"map",p.baseColorTexture)),o.metalness=void 0!==p.metallicFactor?p.metallicFactor:1,o.roughness=void 0!==p.roughnessFactor?p.roughnessFactor:1,void 0!==p.metallicRoughnessTexture&&(l.push(this.assignTexture(o,"metalnessMap",p.metallicRoughnessTexture)),l.push(this.assignTexture(o,"roughnessMap",p.metallicRoughnessTexture)))}!0===i.doubleSided&&(o.side=THREE.DoubleSide);var f=i.alphaMode||H;return f===I?o.transparent=!0:(o.transparent=!1,f===A&&(o.alphaTest=void 0!==i.alphaCutoff?i.alphaCutoff:.5)),void 0!==i.normalTexture&&r!==THREE.MeshBasicMaterial&&(l.push(this.assignTexture(o,"normalMap",i.normalTexture)),o.normalScale=new THREE.Vector2(1,1),void 0!==i.normalTexture.scale&&o.normalScale.set(i.normalTexture.scale,i.normalTexture.scale)),void 0!==i.occlusionTexture&&r!==THREE.MeshBasicMaterial&&(l.push(this.assignTexture(o,"aoMap",i.occlusionTexture)),void 0!==i.occlusionTexture.strength&&(o.aoMapIntensity=i.occlusionTexture.strength)),void 0!==i.emissiveFactor&&r!==THREE.MeshBasicMaterial&&(o.emissive=(new THREE.Color).fromArray(i.emissiveFactor)),void 0!==i.emissiveTexture&&r!==THREE.MeshBasicMaterial&&l.push(this.assignTexture(o,"emissiveMap",i.emissiveTexture)),Promise.all(l).then(function(){var e;return e=r===THREE.ShaderMaterial?a[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(o):new r(o),void 0!==i.name&&(e.name=i.name),e.map&&(e.map.encoding=THREE.sRGBEncoding),e.emissiveMap&&(e.emissiveMap.encoding=THREE.sRGBEncoding),e.specularMap&&(e.specularMap.encoding=THREE.sRGBEncoding),F(e,i),i.extensions&&P(a,e,i),e})},D.prototype.loadGeometries=function(e){var r=this,n=this.extensions,a=this.primitiveCache;function i(e){return n[t.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,r).then(function(t){return O(t,e,r)})}for(var o,s,l=[],u=0,c=e.length;u<c;u++){var p,h=e[u],f=(void 0,(s=(o=h).extensions&&o.extensions[t.KHR_DRACO_MESH_COMPRESSION])?"draco:"+s.bufferView+":"+s.indices+":"+N(s.attributes):o.indices+":"+N(o.attributes)+":"+o.mode),d=a[f];if(d)l.push(d.promise);else p=h.extensions&&h.extensions[t.KHR_DRACO_MESH_COMPRESSION]?i(h):O(new THREE.BufferGeometry,h,r),a[f]={primitive:h,promise:p},l.push(p)}return Promise.all(l)},D.prototype.loadMesh=function(e){for(var t,r=this,n=this.json.meshes[e],a=n.primitives,i=[],o=0,s=a.length;o<s;o++){var l=void 0===a[o].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide})),t.DefaultMaterial):this.getDependency("material",a[o].material);i.push(l)}return i.push(r.loadGeometries(a)),Promise.all(i).then(function(t){for(var i=t.slice(0,t.length-1),o=t[t.length-1],s=[],l=0,u=o.length;l<u;l++){var c,p=o[l],h=a[l],y=i[l];if(h.mode===g||h.mode===E||h.mode===T||void 0===h.mode)!0!==(c=!0===n.isSkinnedMesh?new THREE.SkinnedMesh(p,y):new THREE.Mesh(p,y)).isSkinnedMesh||c.geometry.attributes.skinWeight.normalized||c.normalizeSkinWeights(),h.mode===E?c.geometry=k(c.geometry,THREE.TriangleStripDrawMode):h.mode===T&&(c.geometry=k(c.geometry,THREE.TriangleFanDrawMode));else if(h.mode===d)c=new THREE.LineSegments(p,y);else if(h.mode===m)c=new THREE.Line(p,y);else if(h.mode===v)c=new THREE.LineLoop(p,y);else{if(h.mode!==f)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+h.mode);c=new THREE.Points(p,y)}Object.keys(c.geometry.morphAttributes).length>0&&C(c,n),c.name=n.name||"mesh_"+e,o.length>1&&(c.name+="_"+l),F(c,n),r.assignFinalMaterial(c),s.push(c)}if(1===s.length)return s[0];var R=new THREE.Group;for(l=0,u=s.length;l<u;l++)R.add(s[l]);return R})},D.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],n=r[r.type];if(n)return"perspective"===r.type?t=new THREE.PerspectiveCamera(THREE.Math.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new THREE.OrthographicCamera(n.xmag/-2,n.xmag/2,n.ymag/2,n.ymag/-2,n.znear,n.zfar)),void 0!==r.name&&(t.name=r.name),F(t,r),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},D.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then(function(e){return r.inverseBindMatrices=e,r})},D.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],r=[],n=[],a=[],i=[],o=[],s=0,l=t.channels.length;s<l;s++){var u=t.channels[s],c=t.samplers[u.sampler],p=u.target,f=void 0!==p.node?p.node:p.id,d=void 0!==t.parameters?t.parameters[c.input]:c.input,v=void 0!==t.parameters?t.parameters[c.output]:c.output;r.push(this.getDependency("node",f)),n.push(this.getDependency("accessor",d)),a.push(this.getDependency("accessor",v)),i.push(c),o.push(p)}return Promise.all([Promise.all(r),Promise.all(n),Promise.all(a),Promise.all(i),Promise.all(o)]).then(function(r){for(var n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],l=[],u=0,c=n.length;u<c;u++){var p=n[u],f=a[u],d=i[u],v=o[u],m=s[u];if(void 0!==p){var g;switch(p.updateMatrix(),p.matrixAutoUpdate=!0,x[m.path]){case x.weights:g=THREE.NumberKeyframeTrack;break;case x.rotation:g=THREE.QuaternionKeyframeTrack;break;case x.position:case x.scale:default:g=THREE.VectorKeyframeTrack}var E=p.name?p.name:p.uuid,T=void 0!==v.interpolation?S[v.interpolation]:THREE.InterpolateLinear,y=[];x[m.path]===x.weights?p.traverse(function(e){!0===e.isMesh&&e.morphTargetInfluences&&y.push(e.name?e.name:e.uuid)}):y.push(E);var R=d.array;if(d.normalized){var w;if(R.constructor===Int8Array)w=1/127;else if(R.constructor===Uint8Array)w=1/255;else if(R.constructor==Int16Array)w=1/32767;else{if(R.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");w=1/65535}for(var M=new Float32Array(R.length),b=0,H=R.length;b<H;b++)M[b]=R[b]*w;R=M}for(b=0,H=y.length;b<H;b++){var A=new g(y[b]+"."+x[m.path],f.array,R,T);"CUBICSPLINE"===v.interpolation&&(A.createInterpolant=function(e){return new h(this.times,this.values,this.getValueSize()/3,e)},A.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(A)}}}var I=void 0!==t.name?t.name:"animation_"+e;return new THREE.AnimationClip(I,void 0,l)})},D.prototype.loadNode=function(e){var r,n=this.json,a=this.extensions,i=this,o=n.meshReferences,s=n.meshUses,l=n.nodes[e];return(r=[],void 0!==l.mesh&&r.push(i.getDependency("mesh",l.mesh).then(function(e){var t;if(o[l.mesh]>1){var r=s[l.mesh]++;(t=e.clone()).name+="_instance_"+r,t.onBeforeRender=e.onBeforeRender;for(var n=0,a=t.children.length;n<a;n++)t.children[n].name+="_instance_"+r,t.children[n].onBeforeRender=e.children[n].onBeforeRender}else t=e;return void 0!==l.weights&&t.traverse(function(e){if(e.isMesh)for(var t=0,r=l.weights.length;t<r;t++)e.morphTargetInfluences[t]=l.weights[t]}),t})),void 0!==l.camera&&r.push(i.getDependency("camera",l.camera)),l.extensions&&l.extensions[t.KHR_LIGHTS_PUNCTUAL]&&void 0!==l.extensions[t.KHR_LIGHTS_PUNCTUAL].light&&r.push(i.getDependency("light",l.extensions[t.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(r)).then(function(e){var t;if((t=!0===l.isBone?new THREE.Bone:e.length>1?new THREE.Group:1===e.length?e[0]:new THREE.Object3D)!==e[0])for(var r=0,n=e.length;r<n;r++)t.add(e[r]);if(void 0!==l.name&&(t.userData.name=l.name,t.name=THREE.PropertyBinding.sanitizeNodeName(l.name)),F(t,l),l.extensions&&P(a,t,l),void 0!==l.matrix){var i=new THREE.Matrix4;i.fromArray(l.matrix),t.applyMatrix(i)}else void 0!==l.translation&&t.position.fromArray(l.translation),void 0!==l.rotation&&t.quaternion.fromArray(l.rotation),void 0!==l.scale&&t.scale.fromArray(l.scale);return t})},D.prototype.loadScene=function(){function e(t,r,n,a){var i=n.nodes[t];return a.getDependency("node",t).then(function(e){return void 0===i.skin?e:a.getDependency("skin",i.skin).then(function(e){for(var r=[],n=0,i=(t=e).joints.length;n<i;n++)r.push(a.getDependency("node",t.joints[n]));return Promise.all(r)}).then(function(r){return e.traverse(function(e){if(e.isMesh){for(var n=[],a=[],i=0,o=r.length;i<o;i++){var s=r[i];if(s){n.push(s);var l=new THREE.Matrix4;void 0!==t.inverseBindMatrices&&l.fromArray(t.inverseBindMatrices.array,16*i),a.push(l)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[i])}e.bind(new THREE.Skeleton(n,a),e.matrixWorld)}}),e});var t}).then(function(t){r.add(t);var o=[];if(i.children)for(var s=i.children,l=0,u=s.length;l<u;l++){var c=s[l];o.push(e(c,t,n,a))}return Promise.all(o)})}return function(t){var r=this.json,n=this.extensions,a=this.json.scenes[t],i=new THREE.Scene;void 0!==a.name&&(i.name=a.name),F(i,a),a.extensions&&P(n,i,a);for(var o=a.nodes||[],s=[],l=0,u=o.length;l<u;l++)s.push(e(o[l],i,r,this));return Promise.all(s).then(function(){return i})}}(),e}()),A=r("0exO"),I=r.n(A),L=r("cQq1"),_=r.n(L),P=r("OfFw"),F=r.n(P);THREE.inflate=function(){
/** @license zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */(function(){var e=void 0,t=this;function r(r,n){var a,i=r.split("."),o=t;!(i[0]in o)&&o.execScript&&o.execScript("var "+i[0]);for(;i.length&&(a=i.shift());)i.length||n===e?o=o[a]?o[a]:o[a]={}:o[a]=n}var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array&&"undefined"!=typeof DataView;function a(e){var t,r,a,i,o,s,l,u,c,p,h=e.length,f=0,d=Number.POSITIVE_INFINITY;for(u=0;u<h;++u)e[u]>f&&(f=e[u]),e[u]<d&&(d=e[u]);for(t=1<<f,r=new(n?Uint32Array:Array)(t),a=1,i=0,o=2;a<=f;){for(u=0;u<h;++u)if(e[u]===a){for(s=0,l=i,c=0;c<a;++c)s=s<<1|1&l,l>>=1;for(p=a<<16|u,c=s;c<t;c+=o)r[c]=p;++i}++a,i<<=1,o<<=1}return[r,f,d]}function i(e,t){switch(this.g=[],this.h=32768,this.d=this.f=this.a=this.l=0,this.input=n?new Uint8Array(e):e,this.m=!1,this.i=s,this.r=!1,!t&&(t={})||(t.index&&(this.a=t.index),t.bufferSize&&(this.h=t.bufferSize),t.bufferType&&(this.i=t.bufferType),t.resize&&(this.r=t.resize)),this.i){case o:this.b=32768,this.c=new(n?Uint8Array:Array)(32768+this.h+258);break;case s:this.b=0,this.c=new(n?Uint8Array:Array)(this.h),this.e=this.z,this.n=this.v,this.j=this.w;break;default:throw Error("invalid inflate mode")}}var o=0,s=1,l={t:o,s:s};i.prototype.k=function(){for(;!this.m;){var t=A(this,3);switch(1&t&&(this.m=!0),t>>>=1){case 0:var r=this.input,i=this.a,l=this.c,u=this.b,c=r.length,p=e,h=l.length,d=e;if(this.d=this.f=0,i+1>=c)throw Error("invalid uncompressed block header: LEN");if(p=r[i++]|r[i++]<<8,i+1>=c)throw Error("invalid uncompressed block header: NLEN");if(p===~(r[i++]|r[i++]<<8))throw Error("invalid uncompressed block header: length verify");if(i+p>r.length)throw Error("input buffer is broken");switch(this.i){case o:for(;u+p>l.length;){if(p-=d=h-u,n)l.set(r.subarray(i,i+d),u),u+=d,i+=d;else for(;d--;)l[u++]=r[i++];this.b=u,l=this.e(),u=this.b}break;case s:for(;u+p>l.length;)l=this.e({p:2});break;default:throw Error("invalid inflate mode")}if(n)l.set(r.subarray(i,i+p),u),u+=p,i+=p;else for(;p--;)l[u++]=r[i++];this.a=i,this.b=u,this.c=l;break;case 1:this.j(x,H);break;case 2:var v,m,g,E,T=A(this,5)+257,y=A(this,5)+1,R=A(this,4)+4,w=new(n?Uint8Array:Array)(f.length),M=e,b=e,S=e,L=e,_=e;for(_=0;_<R;++_)w[f[_]]=A(this,3);if(!n)for(_=R,R=w.length;_<R;++_)w[f[_]]=0;for(v=a(w),M=new(n?Uint8Array:Array)(T+y),_=0,E=T+y;_<E;)switch(b=I(this,v)){case 16:for(L=3+A(this,2);L--;)M[_++]=S;break;case 17:for(L=3+A(this,3);L--;)M[_++]=0;S=0;break;case 18:for(L=11+A(this,7);L--;)M[_++]=0;S=0;break;default:S=M[_++]=b}m=a(n?M.subarray(0,T):M.slice(0,T)),g=a(n?M.subarray(T):M.slice(T)),this.j(m,g);break;default:throw Error("unknown BTYPE: "+t)}}return this.n()};var c,p,h=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],f=n?new Uint16Array(h):h,d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],v=n?new Uint16Array(d):d,m=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],g=n?new Uint8Array(m):m,E=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],T=n?new Uint16Array(E):E,y=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=n?new Uint8Array(y):y,w=new(n?Uint8Array:Array)(288);for(c=0,p=w.length;c<p;++c)w[c]=143>=c?8:255>=c?9:279>=c?7:8;var M,b,x=a(w),S=new(n?Uint8Array:Array)(30);for(M=0,b=S.length;M<b;++M)S[M]=5;var H=a(S);function A(e,t){for(var r,n=e.f,a=e.d,i=e.input,o=e.a,s=i.length;a<t;){if(o>=s)throw Error("input buffer is broken");n|=i[o++]<<a,a+=8}return r=n&(1<<t)-1,e.f=n>>>t,e.d=a-t,e.a=o,r}function I(e,t){for(var r,n,a=e.f,i=e.d,o=e.input,s=e.a,l=o.length,u=t[0],c=t[1];i<c&&!(s>=l);)a|=o[s++]<<i,i+=8;if((n=(r=u[a&(1<<c)-1])>>>16)>i)throw Error("invalid code length: "+n);return e.f=a>>n,e.d=i-n,e.a=s,65535&r}function L(e,t){var r,n;switch(this.input=e,this.a=0,!t&&(t={})||(t.index&&(this.a=t.index),t.verify&&(this.A=t.verify)),r=e[this.a++],n=e[this.a++],15&r){case _:this.method=_;break;default:throw Error("unsupported compression method")}if(0!=((r<<8)+n)%31)throw Error("invalid fcheck flag:"+((r<<8)+n)%31);if(32&n)throw Error("fdict flag is not supported");this.q=new i(e,{index:this.a,bufferSize:t.bufferSize,bufferType:t.bufferType,resize:t.resize})}i.prototype.j=function(e,t){var r=this.c,n=this.b;this.o=e;for(var a,i,o,s,l=r.length-258;256!==(a=I(this,e));)if(256>a)n>=l&&(this.b=n,r=this.e(),n=this.b),r[n++]=a;else for(s=v[i=a-257],0<g[i]&&(s+=A(this,g[i])),a=I(this,t),o=T[a],0<R[a]&&(o+=A(this,R[a])),n>=l&&(this.b=n,r=this.e(),n=this.b);s--;)r[n]=r[n++-o];for(;8<=this.d;)this.d-=8,this.a--;this.b=n},i.prototype.w=function(e,t){var r=this.c,n=this.b;this.o=e;for(var a,i,o,s,l=r.length;256!==(a=I(this,e));)if(256>a)n>=l&&(l=(r=this.e()).length),r[n++]=a;else for(s=v[i=a-257],0<g[i]&&(s+=A(this,g[i])),a=I(this,t),o=T[a],0<R[a]&&(o+=A(this,R[a])),n+s>l&&(l=(r=this.e()).length);s--;)r[n]=r[n++-o];for(;8<=this.d;)this.d-=8,this.a--;this.b=n},i.prototype.e=function(){var e,t,r=new(n?Uint8Array:Array)(this.b-32768),a=this.b-32768,i=this.c;if(n)r.set(i.subarray(32768,r.length));else for(e=0,t=r.length;e<t;++e)r[e]=i[e+32768];if(this.g.push(r),this.l+=r.length,n)i.set(i.subarray(a,a+32768));else for(e=0;32768>e;++e)i[e]=i[a+e];return this.b=32768,i},i.prototype.z=function(e){var t,r,a,i=this.input.length/this.a+1|0,o=this.input,s=this.c;return e&&("number"==typeof e.p&&(i=e.p),"number"==typeof e.u&&(i+=e.u)),r=2>i?(a=(o.length-this.a)/this.o[2]/2*258|0)<s.length?s.length+a:s.length<<1:s.length*i,n?(t=new Uint8Array(r)).set(s):t=s,this.c=t},i.prototype.n=function(){var e,t,r,a,i,o=0,s=this.c,l=this.g,u=new(n?Uint8Array:Array)(this.l+(this.b-32768));if(0===l.length)return n?this.c.subarray(32768,this.b):this.c.slice(32768,this.b);for(t=0,r=l.length;t<r;++t)for(a=0,i=(e=l[t]).length;a<i;++a)u[o++]=e[a];for(t=32768,r=this.b;t<r;++t)u[o++]=s[t];return this.g=[],this.buffer=u},i.prototype.v=function(){var e,t=this.b;return n?this.r?(e=new Uint8Array(t)).set(this.c.subarray(0,t)):e=this.c.subarray(0,t):(this.c.length>t&&(this.c.length=t),e=this.c),this.buffer=e},L.prototype.k=function(){var e,t,r=this.input;if(e=this.q.k(),this.a=this.q.a,this.A){t=(r[this.a++]<<24|r[this.a++]<<16|r[this.a++]<<8|r[this.a++])>>>0;var n=e;if("string"==typeof n){var a,i,o=n.split("");for(a=0,i=o.length;a<i;a++)o[a]=(255&o[a].charCodeAt(0))>>>0;n=o}for(var s,l=1,u=0,c=n.length,p=0;0<c;){c-=s=1024<c?1024:c;do{u+=l+=n[p++]}while(--s);l%=65521,u%=65521}if(t!==(u<<16|l)>>>0)throw Error("invalid adler-32 checksum")}return e};var _=8;r("Zlib.Inflate",L),r("Zlib.Inflate.prototype.decompress",L.prototype.k);var P,F,C,N,D={ADAPTIVE:l.s,BLOCK:l.t};if(u.a)P=u()(D);else for(F in P=[],C=0,D)P[C++]=F;for(C=0,N=P.length;C<N;++C)r("Zlib.Inflate.BufferType."+(F=P[C]),D[F])}).call(this)},THREE.inflate(),THREE.FBXLoader=b,THREE.GLTFLoader=H;var C={components:{Footer:s.a},data:function(){return{camera:null,scene:null,renderer:null,mesh:null,tu:[_.a,p.a,f.a,v.a,_.a,_.a,_.a,_.a,_.a,_.a,_.a],cat:_.a,dog:p.a,flag:_.a,house:F.a,petscore:["10","30","50","90","200","400","800","1200"],user:{}}},methods:{jiazai:function(){var e=document.getElementById("container");this.camera=new THREE.PerspectiveCamera(70,e.clientWidth/e.clientHeight,.01,10),this.camera.position.z=.6,this.scene=new THREE.Scene;new THREE.FBXLoader,this.pusheen;for(var t=[],r=0;r<6;++r)t.push(new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture(this.flag,{},function(){renderer.render(I.a,camera)}),overdraw:!0}));var n=new THREE.BoxGeometry(.2,.2,.2);new THREE.MeshNormalMaterial;this.mesh=new THREE.Mesh(n,t),this.scene.add(this.mesh),this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setSize(e.clientWidth,e.clientHeight),e.appendChild(this.renderer.domElement)},animate:function(){requestAnimationFrame(this.animate),this.mesh.rotation.x+=.01,this.mesh.rotation.y+=.02,this.renderer.render(this.scene,this.camera)},before:function(){var e=this;return o()(a.a.mark(function t(){var r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(S.a)();case 2:0!=(r=t.sent).code?(alert(""),e.$router.push({path:"/"})):(void 0==r.data.score&&(r.data.score=1e4),void 0==r.data.pet&&(r.data.pet=0),e.flag=e.tu[r.data.pet],console.log(e.flag),e.user=r.data);case 4:case"end":return t.stop()}},t,e)}))()},upgrade:function(){var e=this;return o()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.user.score>=e.petscore[e.user.pet])){t.next=8;break}return e.user.score=e.user.score-e.petscore[e.user.pet],e.user.pet=e.user.pet+1,t.next=5,Object(x.b)("/api/user/"+e.user._id+"/update",e.user);case 5:e.$message({message:"",type:"success"}),t.next=9;break;case 8:e.$message({message:"",type:"warning"});case 9:case"end":return t.stop()}},t,e)}))()}},mounted:function(){var e=this;this.before().then(function(t){e.jiazai()}),this.animate()}},N={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-container",[r("el-header",{staticStyle:{height:"150px"}},[r("el-row",[r("h1",{staticStyle:{"margin-top":"0px"}},[e._v("")])]),e._v(" "),r("el-row",[e._v("\n      : "+e._s(e.user.pet)+"\n    ")]),e._v(" "),r("el-row",[e._v("\n      : "+e._s(e.user.score)+"\n    ")]),e._v(" "),r("el-row",[e._v("\n      : "+e._s(e.petscore[e.user.pet])+"\n    ")]),e._v(" "),r("el-row",{staticStyle:{"align-items":"center","text-align":"center",color:"#795da3"},on:{click:e.upgrade}},[r("i",{staticClass:"el-icon-ice-cream-round",staticStyle:{"font-size":"30px"},on:{click:e.upgrade}}),e._v("\n    ")])],1),e._v(" "),r("el-main",[r("div",{attrs:{id:"container"}})]),e._v(" "),r("Footer")],1)},staticRenderFns:[]};var D=r("VU/8")(C,N,!1,function(e){r("ED/J")},null,null);t.default=D.exports},uqUo:function(e,t,r){var n=r("kM2E"),a=r("FeBl"),i=r("S82l");e.exports=function(e,t){var r=(a.Object||{})[e]||Object[e],o={};o[e]=t(r),n(n.S+n.F*i(function(){r(1)}),"Object",o)}},ypEA:function(e,t,r){e.exports=r.p+"crab.fbx"}});
//# sourceMappingURL=1.a25504a2e19e0ed3dda1.js.map